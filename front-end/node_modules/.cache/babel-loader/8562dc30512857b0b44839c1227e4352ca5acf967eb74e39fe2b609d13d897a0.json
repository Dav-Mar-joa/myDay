{"ast":null,"code":"import React,{useEffect,useState}from'react';import'./styles/Home.css';import'./styles/Mobile.css';import{Link}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Settings(){const[feelings,setFeelings]=useState([]);const[editingIndex,setEditingIndex]=useState(null);const[modifiedFeelings,setModifiedFeelings]=useState({});const[selectedOption,setSelectedOption]=useState('');const[pseudo,setPseudo]=useState('');const handleSelectionChange=e=>{const newTheme=e.target.value;setSelectedOption(newTheme);document.body.className=newTheme;console.log(\"Thème sélectionné :\",newTheme);if(pseudo){fetch('/setTheme',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({pseudo,theme:newTheme})}).then(res=>res.json()).then(data=>{if(!data.success){console.error(\"Échec de l'enregistrement du thème.\");}}).catch(err=>console.error(\"Erreur en envoyant le thème :\",err));}};useEffect(()=>{const storedPseudo=localStorage.getItem('username');console.log(\"storedPseudo\",storedPseudo);if(storedPseudo){setPseudo(storedPseudo);// Charger le thème depuis la base\nfetch('/getTheme',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({pseudo:storedPseudo})}).then(res=>res.json()).then(data=>{if(data.success&&data.theme){setSelectedOption(data.theme);document.body.className=data.theme;}}).catch(err=>console.error(\"Erreur en récupérant le thème :\",err));}// Charger les émotions\nfetch('/getFeelings').then(res=>res.json()).then(data=>{setFeelings(data.feelings);console.log(\"Emotions récupérées :\",data.feelings);console.log(\"Pseudo depuis /getFeelings :\",data.pseudo);}).catch(err=>console.error(\"Erreur en récupérant les émotions :\",err));},[]);const handleInputChange=(index,value)=>{setModifiedFeelings(prev=>({...prev,[index]:value}));};const updateFeeling=index=>{const newFeeling=modifiedFeelings[index];if(!newFeeling)return;fetch('/updateFeeling',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({index,newFeeling})}).then(res=>res.json()).then(data=>{if(data.success){const updatedFeelings=[...feelings];updatedFeelings[index]=newFeeling;setFeelings(updatedFeelings);setEditingIndex(null);setModifiedFeelings({});}else{console.error(\"Erreur côté serveur :\",data.message);}}).catch(err=>console.error(\"Erreur en mettant à jour :\",err));};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header\",children:/*#__PURE__*/_jsxs(\"h1\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"M\"}),/*#__PURE__*/_jsx(\"span\",{children:\"y\"}),/*#__PURE__*/_jsx(\"span\",{children:\"D\"}),/*#__PURE__*/_jsx(\"span\",{children:\"a\"}),/*#__PURE__*/_jsx(\"span\",{children:\"y\"})]})}),/*#__PURE__*/_jsx(\"h5\",{children:\"Th\\xE8me :\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"theme-select\",className:\"theme-select\",value:selectedOption,onChange:handleSelectionChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"colorful\",children:\"Color\\xE9\"}),/*#__PURE__*/_jsx(\"option\",{value:\"dark\",children:\"Sombre\"})]}),/*#__PURE__*/_jsx(\"h5\",{children:\"\\xC9motions :\"}),/*#__PURE__*/_jsx(\"ol\",{children:feelings.map((f,index)=>/*#__PURE__*/_jsxs(\"ol\",{children:[editingIndex===index?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",defaultValue:f,onChange:e=>handleInputChange(index,e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"button-option\",onClick:()=>updateFeeling(index),children:\"\\u2714\\uFE0F\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button-option\",onClick:()=>setEditingIndex(null),children:\"\\u274C\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[f,/*#__PURE__*/_jsx(\"button\",{className:\"button-option\",onClick:()=>setEditingIndex(index),children:\"\\u270F\\uFE0F\"})]}),index<feelings.length-1&&/*#__PURE__*/_jsx(\"hr\",{className:\"hr-settings\"})]},index))}),/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"submit-button\",children:\"Mes \\xE9motions\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"droits\",children:\"\\xA9 2025 myDay. Tous droits r\\xE9serv\\xE9s. Cette application, ainsi que l\\u2019ensemble de son contenu, est prot\\xE9g\\xE9e par les lois en vigueur relatives \\xE0 la propri\\xE9t\\xE9 intellectuelle. Les donn\\xE9es qu\\u2019elle contient sont chiffr\\xE9es afin d\\u2019en garantir la s\\xE9curit\\xE9.\"})]});}export default Settings;","map":{"version":3,"names":["React","useEffect","useState","Link","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Settings","feelings","setFeelings","editingIndex","setEditingIndex","modifiedFeelings","setModifiedFeelings","selectedOption","setSelectedOption","pseudo","setPseudo","handleSelectionChange","e","newTheme","target","value","document","body","className","console","log","fetch","method","headers","JSON","stringify","theme","then","res","json","data","success","error","catch","err","storedPseudo","localStorage","getItem","handleInputChange","index","prev","updateFeeling","newFeeling","updatedFeelings","message","children","id","onChange","map","f","type","defaultValue","onClick","length","to"],"sources":["C:/Users/850_G5/Documents/Formation_Dot_Net/myday/front-end/src/Settings.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport './styles/Home.css';\r\nimport './styles/Mobile.css';\r\nimport { Link } from 'react-router-dom';\r\n\r\nfunction Settings() {\r\n    const [feelings, setFeelings] = useState([]);\r\n    const [editingIndex, setEditingIndex] = useState(null);\r\n    const [modifiedFeelings, setModifiedFeelings] = useState({});\r\n    const [selectedOption, setSelectedOption] = useState('');\r\n    const [pseudo, setPseudo] = useState('');\r\n\r\n    const handleSelectionChange = (e) => {\r\n        const newTheme = e.target.value;\r\n        setSelectedOption(newTheme);\r\n        document.body.className = newTheme;\r\n        console.log(\"Thème sélectionné :\", newTheme);\r\n\r\n        if (pseudo) {\r\n            fetch('/setTheme', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({ pseudo, theme: newTheme }),\r\n            })\r\n            .then(res => res.json())\r\n            .then(data => {\r\n                if (!data.success) {\r\n                    console.error(\"Échec de l'enregistrement du thème.\");\r\n                }\r\n            })\r\n            .catch(err => console.error(\"Erreur en envoyant le thème :\", err));\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        const storedPseudo = localStorage.getItem('username');\r\n        console.log(\"storedPseudo\",storedPseudo)\r\n        if (storedPseudo) {\r\n            setPseudo(storedPseudo);\r\n\r\n            // Charger le thème depuis la base\r\n            fetch('/getTheme', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ pseudo: storedPseudo })\r\n            })\r\n            .then(res => res.json())\r\n            .then(data => {\r\n                if (data.success && data.theme) {\r\n                    setSelectedOption(data.theme);\r\n                    document.body.className = data.theme;\r\n                }\r\n            })\r\n            .catch(err => console.error(\"Erreur en récupérant le thème :\", err));\r\n        }\r\n\r\n        // Charger les émotions\r\n        fetch('/getFeelings')\r\n        .then(res => res.json())\r\n        .then(data => {\r\n            setFeelings(data.feelings);\r\n            console.log(\"Emotions récupérées :\", data.feelings);\r\n            console.log(\"Pseudo depuis /getFeelings :\", data.pseudo);\r\n        })\r\n        .catch(err => console.error(\"Erreur en récupérant les émotions :\", err));\r\n    }, []);\r\n\r\n    const handleInputChange = (index, value) => {\r\n        setModifiedFeelings(prev => ({\r\n            ...prev,\r\n            [index]: value\r\n        }));\r\n    };\r\n\r\n    const updateFeeling = (index) => {\r\n        const newFeeling = modifiedFeelings[index];\r\n        if (!newFeeling) return;\r\n\r\n        fetch('/updateFeeling', {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({ index, newFeeling })\r\n        })\r\n        .then(res => res.json())\r\n        .then(data => {\r\n            if (data.success) {\r\n                const updatedFeelings = [...feelings];\r\n                updatedFeelings[index] = newFeeling;\r\n                setFeelings(updatedFeelings);\r\n                setEditingIndex(null);\r\n                setModifiedFeelings({});\r\n            } else {\r\n                console.error(\"Erreur côté serveur :\", data.message);\r\n            }\r\n        })\r\n        .catch(err => console.error(\"Erreur en mettant à jour :\", err));\r\n    };\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <div className=\"header\">\r\n                <h1>\r\n                    <span>M</span><span>y</span><span>D</span><span>a</span><span>y</span>\r\n                </h1>\r\n            </div>\r\n\r\n            <h5>Thème :</h5>\r\n            <select id=\"theme-select\" className=\"theme-select\" value={selectedOption} onChange={handleSelectionChange}>\r\n                <option value=\"colorful\">Coloré</option>\r\n                <option value=\"dark\">Sombre</option>\r\n            </select>\r\n\r\n            <h5>Émotions :</h5>\r\n            <ol>\r\n                {feelings.map((f, index) => (\r\n                    <ol key={index}>\r\n                        {editingIndex === index ? (\r\n                            <>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    defaultValue={f}\r\n                                    onChange={(e) => handleInputChange(index, e.target.value)}\r\n                                />\r\n                                <button \r\n                                    className=\"button-option\"\r\n                                    onClick={() => updateFeeling(index)}>✔️</button>\r\n                                <button \r\n                                    className=\"button-option\"\r\n                                    onClick={() => setEditingIndex(null)}>❌</button>\r\n                            </>\r\n                        ) : (\r\n                            <>\r\n                                {f}\r\n                                <button \r\n                                    className=\"button-option\"\r\n                                    onClick={() => setEditingIndex(index)}>✏️</button>\r\n                            </>\r\n                        )}\r\n                        {index < feelings.length - 1 && <hr className=\"hr-settings\" />}\r\n                    </ol>\r\n                ))}\r\n            </ol>\r\n\r\n            <Link to=\"/\">\r\n                <button type=\"button\" className=\"submit-button\">Mes émotions</button>\r\n            </Link>\r\n\r\n            <p className=\"droits\">\r\n                © 2025 myDay. Tous droits réservés. Cette application, ainsi que l’ensemble de son contenu, est protégée par les lois en vigueur relatives à la propriété intellectuelle. Les données qu’elle contient sont chiffrées afin d’en garantir la sécurité.\r\n            </p>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Settings;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}